# [CRYPTO] DeFUNct Ransomware - 50 pts

  

Challenge Description: ![lol it didn't load](https://altelus1.github.io/writeups/ctf/xmasctf2019/images/defunctransomware_1.png)

  
We are given with the following files:

![lol it didn't load](https://altelus1.github.io/writeups/ctf/xmasctf2019/images/defunctransomware_2.png)

  
memos.enc content: 8f14c50f968c43fe3d40ce2692b95fb4e94c17a5dda5eee162fde77a3d0ceb7012a8b367a134194f2d3975def1adfef62657ad456fa527614218c06debaa9348011f3456fa276080e8630f2cbc806273452f4991fd269b97ca158f0264d16f1c76083f3444c6f866b5dcadebddb0687a63a9836380f750be41d423fb07dd595201af564d592a4bf4c2abac822e7d4380a5f795c022a9b2d22d43c129a159d0c5f1b957df94321e10df7c50af3f1dea36808bfa5f164a6a9a65dddee13133fe19ece35f75a969b0f8cff773c32f97cb99e759a6c5f6560c44f0bf6170b4b56c2663ca0d352cf3bb424ee059d375c78fd1ea623c44aaf307bad822f48b8ff881e27c49219d821edadd9e5de82ce9f2ff2eddf76d006adbf16a25e957b692db7c1fe40a2b2d8836039d499893c20aff7d550680c7d3d6bbe0f79dc51676215f1271d7f04ab756ae990f80e1225637ddf5c090a8c446a3a01e3c96368e2ae6b1509e22a6a8c1cf8e120b0c221eeb8fb088460b9177dc52804149504620ecb1c966d44bb6c29eb3c4a4106c486dc9da1562092dc82786628650aea5726f0742d61a40be1a7eb998450a4936bc0d99e3655735532f61c2589c535a77e10a3ae0bea0d8a01aad62e10765190593b2e09f13a6d5bc73b36a5f822542f37115ece855d087232a6d4198b7d1dbdfedf71516199fd5694a1d24993156263f0cb3fb574e491f

  
public content: n: 795569463642685540507503580717531982215679866156448758181874864294322245115046429295501396806569726084791213843313411985306755767933614251017259685360119715465741448841742926933764058184678978561438979554324014291467144646477238464467422645352253054043072408503415623126059018449111807300294890437634529289983603557882115343971407081044050231310858245171002149317227947666679143716043142141154344524386085333349328691743473103727587822968025700198172293605188589348169121979328380110985341428872278372426313622759225108517531628814853640680656657769539723198346005032762702856464738405070059566116940640592020837592563966093405895649052241416909627641069000138027201809936286028443581259045590752809132011594533609186039058798304319124598876514669458750171121861029071117458575853963148168447032328126766812085206373608016609150982512467597800331177524543178311636877811255184421602626713179220562081413985985692847372669113031244726086691179028200044542399429299315486513734144695492816493025225952668485937918985944213972980220480476191347009337324778384697829597183756976186825413917475597248616769321954150777672675555280228376126308362907381766363071890237458517881243184612898247096962136202978853341989193954815333784856612689 e: 13337

  
Since we have the value of n, maybe it can be factored even though it’s very large. Let’s go to this [large number factorization website](https://www.alpertron.com.ar/ECM.HTM).

  
We actually have an answer but we’re only concerned with Euler’s totient:

  
euler_tot = 795569463642685540507503580717531982215679866156448758181874864294322245115046429295501396806569726084791213843313411985306755767933614251017259685360119715465741448841742926933764058184678978561438979554324014291467144646477238464467422645352253054043072408503415623126059018449111807300294890437634529289974129444571536738052570355117041655957194797795932221088165512417385741652358788534138109677638428769384923912855674834081924263955235117285222418082095493531450824685078351263802277062074247864049889090769102738157321783125317563334972475927126639159045005010465255142270934345377339994304284391870997274086299657145887645914183207352738211747434113585868854466417725818033061437465667753585246998223876165557439167293956794262865991380668462719740982987724541500400391567701961940918159642386316128764963374724640309606761513868077290881541455948690259950121789131017262290159942490351322990758776243445625723997047941366665514450305070398888439416362632425588719735162357397479016945380129467671413842072119104000322860831477225418789147099598909139373946098302763513794437681341662578817402330966245646491800413245804870825457441490580402787793311420882850111520005066977852056917452397335125352731022949725920358513273392  
decrypt_key = modinv(e, euler_tot) = 97947443900524080191446418200358964894514983896595100917345619492485351014389010789773809219193783476885894363853986839609634323382094519020045017872183892389199029691695425209960304681655760875600420216555449611351057322449998167403127238784464235940520723908120900740270593708738216059614921653939858820884570784133348078569567408195409942197024357650215243834952970787234564579228696916327118249282619782509563249974433386635864110475706385437679778847626962613679407222981079161367874254774380669773556113596975833849765492081560428806779995911549969370859406030380441549344595800788002719550696181409025832199872837747135601303973069391407073831392878046636924273364167788348975547748266210646095491571088300505759549576117346943062604622258200178886908155195598496187856561008219352702078288430556428239639338779175180953310520039842761612618360251012177164137360557331509685869582782421599486453168672995255112754229040993031774366604253249979366988203302275085602294754186912098713790531166873053644862314045105253694994187994721761839377636465577626666568155763150460347189523338307711960573939225206219655060079369394286413391401284211818353269597162262100913482480941739344161165063870167524617918897779369420501512993545

```python
original_message = pow(memos.enc, decrypt_key, n)
```

  
Original Message: 544f444f0a2d2d2d2d0a0a2a2053746f7020646f776e6c6f6164696e672052414d20666f722074686520696e7465726e65742e0a2a2052656d6f76652079616b756869746f2066726f6d20746865206e617567687479206b696473206c6973742e0a2a204472696e6b20616c6c20746865206d696c6b3b2065617420616c6c2074686520636f6f6b6965730a2a20446f206e6f7420666f726765742074686520666c61673a20582d4d41537b79616b756869746f5f73686f756c645f6e30745f62335f306e5f7468335f6e4075676874795f6c3173745f393431323832613735643839653038307d0a

  

Original Message Ascii: TODO ----

- Stop downloading RAM for the internet.
- Remove yakuhito from the naughty kids list.
- Drink all the milk; eat all the cookies
- Do not forget the flag: X-MAS{yakuhito_should_n0t_b3_0n_th3_n@ughty_l1st_941282a75d89e080}

  
Flag is : _X-MAS{yakuhito_should_n0t_b3_0n_th3_n@ughty_l1st_941282a75d89e080}_

:D Thank you for reading!
